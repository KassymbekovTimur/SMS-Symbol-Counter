# Общий обзор
Данный проект был создан для анализа и обобщения шаблонов SMS-сообщений Основные задачи:
- Предобработка и очистка исходного CSV-файла на SMS сообщения
- Маскировка конфиденциальных данных (номеров, кодов, дат и т.д.)
- Обобщение похожих шаблонов с учётом специальных и общих правил
- Подсчёт длины сообщений и расчёт количества SMS-сегментов.
- Генерация отчётов по наиболее частым шаблонам.

# Установка и запуск
1. Клонировать репозиторий или распаковать ZIP-файл
2. Установить зависимости:
```
pip install -r requirements.txt
```
3. В зависимости от того с чего хотите начать разбор файла выполнить:
   1. Запустить два скрипта для предобработки и анализа:
   ```
   python generaliser.py
   ```
   Затем
    ```
   python aggregator.py
   ```
   Первый файл будет брать с папки `csv/in` или `xlsx/in` файлы соответствующего формата, и обобщать их. После он будет выводить результаты в `csv/out` или `xlsx/out` соответственно.
   Второй файл будет брать уже результаты `generaliser.py` чтобы ещё сильнее обобщить содержимое и сократить количество шаблонов. Результаты будут выводиться в `csv/out` или `xlsx/out`
   2. Проверить конкретное словосочетание в файле
   ```
   python finder.py
   ```
   Нужно заранее прописать какое словосочетание вы хотите найти чтобы код сработал
   3. Посчитать сколько всего строк в файле:
   ```
   python counter.py
   ```
   
# Структура проекта
```
Root
├───counter.py          # Считает количество строк
├───pre_processor.py    # Объединяет сообщения
├───finder.py           # Находит сообщения
├───pattern_utils.py    # Утилиты для паттернов
├───requirements.txt    # Библиотеки
├───generaliser.py      # Обобщает паттерны с папок данных 
├───aggregator.py       # Аггрегирует паттерны
└───top_msgs_counter.py # Выводит топ Х паттернов
```
# Модули
## Считыватель `counter.py`
Данный модуль отвечает за считывание количества строк в папках данных. 
Чтобы его использовать нужно поменять переменную `FILENAME` с соответствующим путём файла, далее изменяете разделитель `SEP`.
## Утилиты `pattern_utils.py`
Модуль содержит функции и переменные для обобщения сообщений и шаблонов
Функция `dynamic_mask` заменяет все чувствительные данные (номера, карты, коды и т.д.) в `{NUM}`, `{MONEY}`,`{CODE}` и другие.
Функция `super_generalise` применяет словарь специальных правил `SPECIALS` перед обобщением, затем применяется обычные правила обобщения.
## Обобщитель `generaliser.py`
Модуль отвечает за полное обобщение сообщений разделяя их на паттерны и выводя результаты для дальнейшей работы
## Аггрегатор `aggregator.py`
Модуль отвечает за дополнительный слой обобщения (аггрегацию) данных взятых из прндыдущих результатов
## Поисковик `finder.py`
Модуль позволяет найти конкретное сообщение в файле данных и их количество если таковых несколько
## Счётчик `counter.py`
Модуль позволяет посчитать общее количество данных (строк) в файле данных (не учитывает загаловок)
## Счётчик часто встречаемых `top_msgs_counter.py`
При запуске модуля позволяет увидеть топ `Х` данных которые встречаются в файле данных, где `Х` можно изменить на любое число
## Предобработчик `pre_processor.py`
Модуль планировался как объединитель сообщений чтобы уменьшить количество сообщений, однако имеет недостатки которые в конечном итоге перестали быть релевантными, однако был добавлен в репозиторий для предложений к улучшению и дальнейшей модернизации
### Примечание к использованию
Из-за того что Git никогда не будет добавлять пустые папки рекомендуется после клонирования репозитория/распаковки ZIP файла создать папки связанные с типом данным с которым нужно работать (например, создать `csv/in` и `csv/out` для данных связанные с файлами в формате csv)
